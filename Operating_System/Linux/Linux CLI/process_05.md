#  Мониторинг процессов
- Мониторинг процессов: ps, htop, lsof...
---
# :bulb:  Команда «ps»

> ps (processes status) — собственная утилита Unix/Linux для просмотра информации о выбранных запущенных процессах в системе: она считывает эту информацию из виртуальных файлов в файловой системе /proc. 

> :mag_right: "Эта команда поможет вам понять, что происходит в системе Linux.

Запуск команды ps **без аргументов** выводит все процессы запущенные в данный момент
```
ps
```
Чтобы вывести больше информации о процессах используйте опцию -f:
```
ps -f
```

<p align="center" width="100%">
    <img src="https://github.com/airgedon/DevOps/blob/main/Operating_System/Linux/Linux%20CLI/PNG/Screenshot%20from%202022-08-15%2011-00-27.png"> 
</p>

<details>
<summary><b>More details</b></summary>
- UID - пользователь, от имени которого запущен процесс;
- ID - идентификатор процесса;
- PPID - идентификатор родительского процесса; 
- C - процент времени CPU, используемого процессом;
- STIME - время запуска процесса;
- TTY - терминал, из которого запущен процесс;
- TIME - общее время процессора, затраченное на выполнение процессора;
- CMD - команда запуска процессора;
- LWP - показывает потоки процессора;
- PRI - приоритет процесса.
</details>
 
# :bulb:  Команда «htop»

> Показывает информацию о процессах в реальном времени, выводет данные о потреблении системных ресурсов и позволяет искать, останавливать и управлять процессами.

### Как установить htop

> :mag_right: В Debian, Linux Mint, Ubuntu, Kali Linux и их производных выполните:
```
sudo apt install htop
```
> :mag_right: В Arch Linux, Manjaro, BlackArch и их производных выполните:
```
sudo pacman -Syu htop
```
### Как просмотреть все процессы в Linux
```
htop
```

<p align="center" width="100%">
    <img src="https://github.com/airgedon/DevOps/blob/main/Operating_System/Linux/Linux%20CLI/PNG/Screenshot%20from%202022-08-15%2011-04-03.png"> 
</p>

<details>
<summary><b>More details</b></summary>
* Позволяет выбирать несколько процессов из списка:
  * клавиша пробел — выделение одного процесса;
  * клавиша C— выделение процесса и всех его дочерних процессов;
  * клавиша U — отменить выделение;
* Позволяет выполнять поиск по pid (клавиши цифр) или по имени процесса (клавиши / и );
* Позволяет просматривать открытые процессом файлы (клавиша l) (аналог функционала утилиты lsof);
* Позволяет следить за системными вызовами процесса (клавиша s) (аналог функционала утилиты strace (англ.));
* Позволяет следить за системными вызовами процесса (клавиша s) (аналог функционала утилиты strace (англ.));
* Позволяет просматривать процессы, запущенные от имени одного пользователя (клавиша u);
* Может выводить процессы в виде дерева (клавиша t) (аналог функционала утилиты pstree (англ.));
* Может показывать потоки процессов пользователя (клавиша H) и потоки ядра (клавиша K);
* Использует CSI коды для разукрашивания выводимого текста.
 </details>


# :bulb: Команда «lsof»

> lsof используется для просмотра всех других устройств и процессов, которые обрабатываются как файлы.

> :mag_right: lsof означает ‘LiSt Open Files’ (список открытых файлов). Эта программа используется чтобы узнать, какие файлы открыты и каким процессом, использует ли кто-то файл, и если да, то кто. 

```
lsof /dev/null
```

<p align="center" width="100%">
    <img src="https://github.com/airgedon/DevOps/blob/main/Operating_System/Linux/Linux%20CLI/PNG/Screenshot%20from%202022-08-15%2011-09-53.png"> 
</p>

Список всех открытых файлов в Linux:

Чтобы вывести список файлов, открытых для конкретного пользователя, выполните следующую команду: замените **devops** вашим именем пользователя.
```
lsof -u devops
```
Список файлов, открытых пользователем:

> :mag_right: Еще одно важное использование lsof - выяснение процесса прослушивания определенного порта. Например, определите процесс, прослушивающий порт 80, с помощью следующей команды.

```
sudo lsof -i TCP:80
```
Процессы, прослушивающие порт:

<p align="center" width="100%">
    <img src="https://github.com/airgedon/DevOps/blob/main/Operating_System/Linux/Linux%20CLI/PNG/Screenshot%20from%202022-08-15%2011-06-18.png"> 
</p>


> :warning: Примечание: поскольку lsof читает память ядра при поиске открытых файлов, быстрые изменения в памяти ядра могут привести к непредсказуемым результатам. Это один из основных недостатков использования команды lsof.
